---
layout: post
title: "Reinforcement Learning Quantum State Preparation" 
index: Reinforcement Learning Quantum State Preparation
date:   2017-04-01 12:00:00
categories: ML
author: Marin Bukov
image: /img/RL_bloch.png
---
A ***Reinforcement Learning*** agent learns to ***Prepare Quantum States*** in a non-integrable Ising chain. With no
prior knowledge about the quantum system, the agent learns to extract the essential features of the optimal preparation protocol.

Machine Learning (ML) ideas have recently been applied to physics to detect phase transitions <span style="color:blue">[1]</span>, and extract the essence of quantum mechanical wavefunctions <span style="color:blue">[2]</span>. I have recently become interested in developing and applying Reinforcement Learning (RL) algorithms to study quantum dynamics. RL is a subfield of ML where a computer agent is taught to master a specific task by performing a series of actions in order to maximize a reward function. RL was used in the 90's to create a computer agent to beat the world's best backgammon players <span style="color:blue">[3]</span>. Recently, Google DeepMind succeeded in teaching a RL agent to play the video games Atari and Go <span style="color:blue">[4,5]</span>. Inspired by this success, we decided to investigate what insights in physics can be gained from such an approach.

<table class="image" align="center">
<caption align="bottom">{{ "<i>Our computer agent learning how to prepare a target state for a single qubit [7].</i>" }}</caption>
<tr><td>
	<video width='504' height='326' preload='none' controls poster='/img/RL_bloch.png'>
		<source src='/movies/qubit.mp4' />
		<source src='/movies/qubit.ogv' />
		<source src='/movies/qubit.webm'/>
	</video>
</td></tr>
</table> 
\\
***How does it Work?***---We used a modified version of Watkins online Q-learning algorithm with linear function approximation and eligibility traces <span style="color:blue">[6]</span> to teach a RL agent to find an optimal protocol sequence to prepare a quantum system in a pre-defined target state <span style="color:blue">[7]</span>. To manipulate the system, our computer agent constructs piecewise-constant protocols of duration $T$ by choosing a drive protocol strength $h_x(t)$ at each discrete time step $t$. One can think of $h_x(t)$ as a magnetic field applied to the system or, more generally --- as a control knob. In order to make the agent learn, it is given a reward for every protocol it constructs -- the fidelity $ F_h(T)=\\lvert \\langle\\psi_\\ast \\vert \\psi(T)\\rangle
\\rvert ^2 $ for being in the target state after time $T$ following the protocol $h_x(t)$ *obeying the laws of Quantum Dynamics*. The goal of the agent is to maximize the reward $ F_h(T)$ in a series of attempts. Deprived of any knowledge about the underlying physical model, the agent collects information about already tried protocols, based on which it constructs new, improved protocols through a sophisticated biased sampling algorithm[RL paper]. For simplicity, consider bang-bang protocols, (see Fig.), where $h_x(t)\\in\\{\pm 4\\}$, although we verified that RL also works for quasi-continuous protocols with many different protocol steps. You can learn more about our work in [this paper](https://arxiv.org/abs/1705.00565). 

<table class="image" align="right">
<caption align="bottom" style="text-align:center" >{{ "<i>Bang-bang protocols found by the RL agent for the single qubit (red) and the corresponding variational protocols (blue) [7].</i>" }}
</caption>
<tr><td><img align="right" src="/img/RL_protocols.png" alt="Drawing" style="width: 320px;"/></td></tr>
</table>
***Model***---To test the agent, we decided to prepare states in the transverse-field Ising chain:

$$ H(t) = -\sum_{j=1}^L \left( JS^z_{j+1}S^z_j + S^z_j + h_x(t)S^x_j\right) $$

To make the model untractable by perturbative analytical calculations, we add a parallel field and choose all couplings to be of the same order of magnitude so there is no small paramter. This model is known to be nonintegrable, and features thermalising (chaotic) dynamics. We choose the paramagnetic ground states of the above Hamiltonian at fields $h_x/J=-2$ and $h_x/J=2$ for the initial and target state, respectively. Even though there is only one control field in the problem, the space of available protocols grows exponentially with the inverse time step size and we have demonstrated numerically that it is exponentially hard to find the optimal protocol <span style="color:blue">[8]</span>.

***Constrained Qubit Manipulation***---To benchmark the performace of the RL agent, let us first set $J=0$, so that the model decouples into a sequence of independent quantum bits, known as qubits. The movie above below shows the learning process of the RL agent for a single qubit. Notice that the protocol the agent finds after a series of attempts has a remarkable feature: without any prior knowledge about the intermediate quantum state nor its Bloch sphere representation [an effective geometric description for the quantum degrees of freedom of a single qubit], the RL agent discovers that it is advantageous to first bring the state to the equator -- which is a geodesic -- and then effectively turns off the field $h_x(t)$, to enable the fastest possible precession about the $\hat z$-axis. After staying on the equator for as long as optimal, the agent rotates as fast as it can to bring the state as close as possible to the target, thus optimizing the final fidelity for the available protocol duration.


<table class="image" align="center">
<caption align="bottom"><i>Learning how to prepare a target state in a system of many coupled qubits [7].</i></caption>
<tr><td>
	<video width="504" height="326" preload="metadata" controls="">
		<source src="/movies/many_qubits.mp4#t=0.3" />
		<source src="/movies/many_qubits.ogv#t=0.3" />
		<source src="/movies/many_qubits.webm#t=0.3" />
	</video></td></tr>
</table> 
\\
***Many Coupled Qubits***---Back to the non-integrable model $J=1$, it is impossible to visualise the driving protocol due to the exponentially many degrees of freedom in the problem. However, by putting the system on a closed chain and making use of translation invariance, all qubits behave in the same way on every lattice site. Hence, we can trace out all sites but one, and study the properties of the underlying reduced density matrix of the remaining qubit on the Bloch sphere. The second movie shows how our RL agent learns the physics of the many-body system. This counter-intuitive solution can also be found using optimal control algorithms, such as GRAPE <span style="color:blue">[9]</span>, and hints towards the existence of bizzare principles that govern the physics of systems away from equilibrium.

*References*:\\
<a href="https://www.nature.com/nphys/journal/v13/n5/full/nphys4035.html" style="color: #0000cd">[1] J. Carrasquilla and R. G. Melko, *Nat. Phys.* **13**, 431 (2017).</a>\\
<a href="http://science.sciencemag.org/content/355/6325/602" style="color: #0000cd">[2] G. Carleo and M. Troyer, *Science* **355**, 602 (2017).</a>\\
<a href="http://dl.acm.org/citation.cfm?doid=203330.203343" style="color: #0000cd">[3] G. Tesauro, *Communications of the ACM.* **38** (3) (1995).</a>\\
<a href="https://www.nature.com/nature/journal/v518/n7540/full/nature14236.html" style="color: #0000cd">[4] V. Mnih *et al.*, *Nature* **518**, 529 (2015), letter.</a>\\
<a href="https://www.nature.com/nature/journal/v518/n7540/full/nature14236.html" style="color: #0000cd">[5] D. Silver,*et al.*, *Nature* **529**, 484 (2016), article.</a>\\
<a href="http://people.inf.elte.hu/lorincz/Files/RL_2006/SuttonBook.pdf" style="color: #0000cd">[6] R. S. Sutton and A. G. Barto, *Reinforcement Learning: An Introduction* (MIT Press, Cambridge, MA, 2017).</a>\\
<a href="https://arxiv.org/abs/1705.00565" style="color: #0000cd">[7] **M.B.**, A.G.R. Day, D. Sels, P. Weinberg, A. Polkovnikov, P. Mehta, *arXiv: 1705.00565* (2017).</a>\\
<a href="" style="color: #0000cd">[8] A.G.R. Day, **M.B.**, P. Weinberg, A. Polkovnikov, P. Mehta, and D. Sels, *in preparation* (2017).</a>\\
<a href="" style="color: #0000cd">[9] N. Khaneja, T. Reiss, C. Kehlet, T. Schulte-Herbrüggen, and S. J. Glaser, *Journal of Magnetic Resonance* **172**, 296 (2005).</a>

Copyright © 2017 Marin Bukov
